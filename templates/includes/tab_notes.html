<!-- templates/includes/tab_notes.html -->
<div class="tab-pane active">
    <h2 class="mb-4">üìù –ë–ª–æ–∫–Ω–æ—Ç –¥–ª—è –∑–∞–º–µ—Ç–æ–∫</h2>
    <div class="card">
        <div class="card-body">
            <textarea id="notesText" class="form-control" rows="20" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–º–µ—Ç–∫–∏..."></textarea>
            <small class="text-muted mt-2 d-block">‚è≥ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</small>
        </div>
    </div>
</div>

<script>
var notesTimeout;
window.init_notes = function() {
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–º–µ—Ç–∫–∏
    $.get('/api/note/', function(data) {
        $('#notesText').val(data.content);
    });
    
    // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –≤–≤–æ–¥–µ
    $('#notesText').off('input').on('input', function() {
        clearTimeout(notesTimeout);
        notesTimeout = setTimeout(function() {
            var content = $('#notesText').val();
            $.post('/api/note/save/', {content: content});
        }, 1000); // –∑–∞–¥–µ—Ä–∂–∫–∞ 1 —Å–µ–∫—É–Ω–¥–∞
    });
};
</script>